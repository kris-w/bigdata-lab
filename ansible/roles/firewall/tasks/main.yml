---
- name: Ensure UFW is installed
  apt:
    name: ufw
    state: present

- name: Allow SSH from your IP
  ufw:
    rule: allow
    proto: tcp
    from_ip: "{{ ALLOWED_CLIENT_IP }}"
    port: 22

- name: Allow VM1 â†’ Elasticsearch port (9200)
  ufw:
    rule: allow
    proto: tcp
    from_ip: "{{ VM1_IP }}"
    port: 9200

- name: Allow Kibana access from your IP
  ufw:
    rule: allow
    proto: tcp
    from_ip: "{{ ALLOWED_CLIENT_IP }}"
    port: 5601

- name: Enable UFW
  ufw:
    state: enabled
    policy: deny
